<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
    crossorigin="anonymous"
  />
    <title>Index</title>
  </head>
  <body>

    <%-include('../pages/bloques/header') %>

    <div class="container">
      <a class="btn btn-dark btn-sm" href="/API/add2">Añadir</a>
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Id#</th>
            <th scope="col">Nombre</th>
            <th scope="col">Especie</th>
            <th scope="col">Afiliciaon</th>
            <th scope="col">Nacimiento</th>
            <th scope="col">Paneta natal</th>
          </tr>
        </thead>
        <tbody>
          <ul>
            <tr>
              <th scope="row"><%= personaje.id %></th>
              <td><%= personaje.nombre %></td>
              <td><%= personaje.especie %></td>
              <td><%= personaje.afiliacion %></td>
              <td><%= personaje.nacimiento %></td>
              <td><%= personaje.planeta_natal %></td>
               <td>
                <button
                class="btn btn-danger btn-sm"
                id="btnEliminar"
                data-id="<%= personaje.id %>"
                >
                Eliminar
                </button>
              
            </tr>
          </ul>
        </tbody>
      </table>
    </div>
  </body>
  <%- include('../pages/bloques/footer') %>
</html>

<script>

  const btnEliminar = document.querySelector('.btn-danger')
    btnEliminar.addEventListener('click', async() => {
      try {
        alert('⚠ Este dato se borra definitivamente de su base de dato ⚠');
      
          const data = await fetch(`/api2/${btnEliminar.dataset.id}`, {
            method: 'delete'
          })
          const res = await data.json()
          // console.log(res)
          if(res.estado){
              window.location.href = '/API/GetAll2'
          }else{
              // console.log(res)
          }
      } catch (error) {
          console.log(error)
      }
    })
  
  </script>